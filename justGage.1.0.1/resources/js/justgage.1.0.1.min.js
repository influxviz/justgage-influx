function getColor(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m,g,y;var r=r||i.length>0;if(i.length>0){for(var b=0;b<i.length;b++){if(e>i[b].lo&&e<=i[b].hi){return i[b].color}}}s=n.length;if(s===1)return n[0];o=r?1/s:1/(s-1);u=[];for(b=0;b<n.length;b++){a=r?o*(b+1):o*b;f=parseInt(cutHex(n[b]).substring(0,2),16);l=parseInt(cutHex(n[b]).substring(2,4),16);c=parseInt(cutHex(n[b]).substring(4,6),16);u[b]={pct:a,color:{r:f,g:l,b:c}}}if(t===0){return"rgb("+[u[0].color.r,u[0].color.g,u[0].color.b].join(",")+")"}for(var w=0;w<u.length;w++){if(t<=u[w].pct){if(r){return"rgb("+[u[w].color.r,u[w].color.g,u[w].color.b].join(",")+")"}else{h=u[w-1];p=u[w];d=p.pct-h.pct;v=(t-h.pct)/d;m=1-v;g=v;y={r:Math.floor(h.color.r*m+p.color.r*g),g:Math.floor(h.color.g*m+p.color.g*g),b:Math.floor(h.color.b*m+p.color.b*g)};return"rgb("+[y.r,y.g,y.b].join(",")+")"}}}}function setDy(e,t,n){if((!ie||ie>9)&&e.node.firstChild.attributes.dy){e.node.firstChild.attributes.dy.value=0}}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function cutHex(e){return e.charAt(0)=="#"?e.substring(1,7):e}function humanFriendlyNumber(e,t){var n,r,i,s;n=Math.pow;r=n(10,t);i=7;while(i){s=n(10,i--*3);if(s<=e){e=Math.round(e*r/s)/r+"KMGTPE"[i]}}return e}function formatNumber(e){var t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return t.join(".")}function getStyle(e,t){var n="";if(document.defaultView&&document.defaultView.getComputedStyle){n=document.defaultView.getComputedStyle(e,"").getPropertyValue(t)}else if(e.currentStyle){t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});n=e.currentStyle[t]}return n}function onCreateElementNsReady(e){if(document.createElementNS!==undefined){e()}else{setTimeout(function(){onCreateElementNsReady(e)},100)}}JustGage=function(e){var t=this;if(e===null||e===undefined){console.log("* justgage: Make sure to pass options to the constructor!");return false}var n;if(e.id!==null&&e.id!==undefined){n=document.getElementById(e.id);if(!n){console.log("* justgage: No element with id : %s found",e.id);return false}}else if(e.parentNode!==null&&e.parentNode!==undefined){n=e.parentNode}else{console.log("* justgage: Make sure to pass the existing element id or parentNode to the constructor.");return false}var r=n.dataset?n.dataset:{};t.config={id:e.id,parentNode:t.kvLookup("parentNode",e,r,null),width:t.kvLookup("width",e,r,null),height:t.kvLookup("height",e,r,null),title:t.kvLookup("title",e,r,""),titleFontColor:t.kvLookup("titleFontColor",e,r,"#999999"),value:t.kvLookup("value",e,r,0,"float"),valueFontColor:t.kvLookup("valueFontColor",e,r,"#010101"),symbol:t.kvLookup("symbol",e,r,""),min:t.kvLookup("min",e,r,0,"float"),max:t.kvLookup("max",e,r,100,"float"),humanFriendlyDecimal:t.kvLookup("humanFriendlyDecimal",e,r,0),textRenderer:t.kvLookup("textRenderer",e,r,null),gaugeWidthScale:t.kvLookup("gaugeWidthScale",e,r,1),gaugeColor:t.kvLookup("gaugeColor",e,r,"#edebeb"),label:t.kvLookup("label",e,r,""),labelFontColor:t.kvLookup("labelFontColor",e,r,"#b3b3b3"),shadowOpacity:t.kvLookup("shadowOpacity",e,r,.2),shadowSize:t.kvLookup("shadowSize",e,r,5),shadowVerticalOffset:t.kvLookup("shadowVerticalOffset",e,r,3),levelColors:t.kvLookup("levelColors",e,r,["#a9d70b","#f9c802","#ff0000"],"array",","),startAnimationTime:t.kvLookup("startAnimationTime",e,r,700),startAnimationType:t.kvLookup("startAnimationType",e,r,">"),refreshAnimationTime:t.kvLookup("refreshAnimationTime",e,r,700),refreshAnimationType:t.kvLookup("refreshAnimationType",e,r,">"),donutStartAngle:t.kvLookup("donutStartAngle",e,r,90),valueMinFontSize:t.kvLookup("valueMinFontSize",e,r,16),titleMinFontSize:t.kvLookup("titleMinFontSize",e,r,10),labelMinFontSize:t.kvLookup("labelMinFontSize",e,r,10),minLabelMinFontSize:t.kvLookup("minLabelMinFontSize",e,r,10),maxLabelMinFontSize:t.kvLookup("maxLabelMinFontSize",e,r,10),hideValue:t.kvLookup("hideValue",e,r,false),hideMinMax:t.kvLookup("hideMinMax",e,r,false),hideInnerShadow:t.kvLookup("hideInnerShadow",e,r,false),humanFriendly:t.kvLookup("humanFriendly",e,r,false),noGradient:t.kvLookup("noGradient",e,r,false),donut:t.kvLookup("donut",e,r,false),relativeGaugeSize:t.kvLookup("relativeGaugeSize",e,r,false),counter:t.kvLookup("counter",e,r,false),decimals:t.kvLookup("decimals",e,r,0),customSectors:t.kvLookup("customSectors",e,r,[]),formatNumber:t.kvLookup("formatNumber",e,r,false)};var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;if(t.config.value>t.config.max)t.config.value=t.config.max;if(t.config.value<t.config.min)t.config.value=t.config.min;t.originalValue=t.kvLookup("value",e,r,-1,"float");if(t.config.id!==null&&document.getElementById(t.config.id)!==null){t.canvas=Raphael(t.config.id,"100%","100%")}else if(t.config.parentNode!==null){t.canvas=Raphael(t.config.parentNode,"100%","100%")}if(t.config.relativeGaugeSize===true){t.canvas.setViewBox(0,0,200,150,true)}if(t.config.relativeGaugeSize===true){i=200;s=150}else if(t.config.width!==null&&t.config.height!==null){i=t.config.width;s=t.config.height}else if(t.config.parentNode!==null){t.canvas.setViewBox(0,0,200,150,true);i=200;s=150}else{i=getStyle(document.getElementById(t.config.id),"width").slice(0,-2)*1;s=getStyle(document.getElementById(t.config.id),"height").slice(0,-2)*1}if(t.config.donut===true){if(i>s){u=s;o=u}else if(i<s){o=i;u=o;if(u>s){a=u/s;u=u/a;o=u/a}}else{o=i;u=o}f=(i-o)/2;l=(s-u)/2;c=u/8>10?u/10:10;h=f+o/2;p=l+u/11;d=u/6.4>16?u/5.4:18;v=f+o/2;if(t.config.label!==""){m=l+u/1.85}else{m=l+u/1.7}g=u/16>10?u/16:10;y=f+o/2;b=m+g;w=u/16>10?u/16:10;E=f+o/10+o/6.666666666666667*t.config.gaugeWidthScale/2;S=b;x=u/16>10?u/16:10;T=f+o-o/10-o/6.666666666666667*t.config.gaugeWidthScale/2;N=b}else{if(i>s){u=s;o=u*1.25;if(o>i){a=o/i;o=o/a;u=u/a}}else if(i<s){o=i;u=o/1.25;if(u>s){a=u/s;u=u/a;o=u/a}}else{o=i;u=o*.75}f=(i-o)/2;l=(s-u)/2;c=u/8>t.config.titleMinFontSize?u/10:t.config.titleMinFontSize;h=f+o/2;p=l+u/6.4;d=u/6.5>t.config.valueMinFontSize?u/6.5:t.config.valueMinFontSize;v=f+o/2;m=l+u/1.275;g=u/16>t.config.labelMinFontSize?u/16:t.config.labelMinFontSize;y=f+o/2;b=m+d/2+5;w=u/16>t.config.minLabelMinFontSize?u/16:t.config.minLabelMinFontSize;E=f+o/10+o/6.666666666666667*t.config.gaugeWidthScale/2;S=b;x=u/16>t.config.maxLabelMinFontSize?u/16:t.config.maxLabelMinFontSize;T=f+o-o/10-o/6.666666666666667*t.config.gaugeWidthScale/2;N=b}t.params={canvasW:i,canvasH:s,widgetW:o,widgetH:u,dx:f,dy:l,titleFontSize:c,titleX:h,titleY:p,valueFontSize:d,valueX:v,valueY:m,labelFontSize:g,labelX:y,labelY:b,minFontSize:w,minX:E,minY:S,maxFontSize:x,maxX:T,maxY:N};i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N=null;t.canvas.customAttributes.pki=function(e,t,n,r,i,s,o,u,a){var f,l,c,h,p,d,v,m,g,y;if(a){f=(1-2*(e-t)/(n-t))*Math.PI;l=r/2-r/7;c=l-r/6.666666666666667*u;h=r/2+s;p=i/1.95+o;d=r/2+s+l*Math.cos(f);v=i-(i-p)-l*Math.sin(f);m=r/2+s+c*Math.cos(f);g=i-(i-p)-c*Math.sin(f);y="M"+(h-c)+","+p+" ";y+="L"+(h-l)+","+p+" ";if(e>(n-t)/2){y+="A"+l+","+l+" 0 0 1 "+(h+l)+","+p+" "}y+="A"+l+","+l+" 0 0 1 "+d+","+v+" ";y+="L"+m+","+g+" ";if(e>(n-t)/2){y+="A"+c+","+c+" 0 0 0 "+(h+c)+","+p+" "}y+="A"+c+","+c+" 0 0 0 "+(h-c)+","+p+" ";y+="Z ";return{path:y}}else{f=(1-(e-t)/(n-t))*Math.PI;l=r/2-r/10;c=l-r/6.666666666666667*u;h=r/2+s;p=i/1.25+o;d=r/2+s+l*Math.cos(f);v=i-(i-p)-l*Math.sin(f);m=r/2+s+c*Math.cos(f);g=i-(i-p)-c*Math.sin(f);y="M"+(h-c)+","+p+" ";y+="L"+(h-l)+","+p+" ";y+="A"+l+","+l+" 0 0 1 "+d+","+v+" ";y+="L"+m+","+g+" ";y+="A"+c+","+c+" 0 0 0 "+(h-c)+","+p+" ";y+="Z ";return{path:y}}f,l,c,h,p,d,v,m,g,y=null};t.gauge=t.canvas.path().attr({stroke:"none",fill:t.config.gaugeColor,pki:[t.config.max,t.config.min,t.config.max,t.params.widgetW,t.params.widgetH,t.params.dx,t.params.dy,t.config.gaugeWidthScale,t.config.donut]});t.level=t.canvas.path().attr({stroke:"none",fill:getColor(t.config.value,(t.config.value-t.config.min)/(t.config.max-t.config.min),t.config.levelColors,t.config.noGradient,t.config.customSectors),pki:[t.config.min,t.config.min,t.config.max,t.params.widgetW,t.params.widgetH,t.params.dx,t.params.dy,t.config.gaugeWidthScale,t.config.donut]});if(t.config.donut){t.level.transform("r"+t.config.donutStartAngle+", "+(t.params.widgetW/2+t.params.dx)+", "+(t.params.widgetH/1.95+t.params.dy))}t.txtTitle=t.canvas.text(t.params.titleX,t.params.titleY,t.config.title);t.txtTitle.attr({"font-size":t.params.titleFontSize,"font-weight":"bold","font-family":"Arial",fill:t.config.titleFontColor,"fill-opacity":"1"});setDy(t.txtTitle,t.params.titleFontSize,t.params.titleY);t.txtValue=t.canvas.text(t.params.valueX,t.params.valueY,0);t.txtValue.attr({"font-size":t.params.valueFontSize,"font-weight":"bold","font-family":"Arial",fill:t.config.valueFontColor,"fill-opacity":"0"});setDy(t.txtValue,t.params.valueFontSize,t.params.valueY);t.txtLabel=t.canvas.text(t.params.labelX,t.params.labelY,t.config.label);t.txtLabel.attr({"font-size":t.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:t.config.labelFontColor,"fill-opacity":"0"});setDy(t.txtLabel,t.params.labelFontSize,t.params.labelY);t.txtMinimum=t.config.min;if(t.config.humanFriendly){t.txtMinimum=humanFriendlyNumber(t.config.min,t.config.humanFriendlyDecimal)}else if(t.config.formatNumber){t.txtMinimum=formatNumber(t.config.min)}t.txtMin=t.canvas.text(t.params.minX,t.params.minY,t.txtMinimum);t.txtMin.attr({"font-size":t.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:t.config.labelFontColor,"fill-opacity":t.config.hideMinMax||t.config.donut?"0":"1"});setDy(t.txtMin,t.params.minFontSize,t.params.minY);t.txtMaximum=t.config.max;if(t.config.formatNumber){t.txtMaximum=formatNumber(t.txtMaximum)}else if(t.config.humanFriendly){t.txtMaximum=humanFriendlyNumber(t.config.max,t.config.humanFriendlyDecimal)}t.txtMax=t.canvas.text(t.params.maxX,t.params.maxY,t.txtMaximum);t.txtMax.attr({"font-size":t.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:t.config.labelFontColor,"fill-opacity":t.config.hideMinMax||t.config.donut?"0":"1"});setDy(t.txtMax,t.params.maxFontSize,t.params.maxY);var C=t.canvas.canvas.childNodes[1];var k="http://www.w3.org/2000/svg";if(ie!=="undefined"&&ie<9){}else if(ie!=="undefined"){onCreateElementNsReady(function(){t.generateShadow(k,C)})}else{t.generateShadow(k,C)}C,k=null;if(t.config.textRenderer){t.originalValue=t.config.textRenderer(t.originalValue)}else if(t.config.humanFriendly){t.originalValue=humanFriendlyNumber(t.originalValue,t.config.humanFriendlyDecimal)+t.config.symbol}else if(t.config.formatNumber){t.originalValue=formatNumber(t.originalValue)+t.config.symbol}else{t.originalValue=(t.originalValue*1).toFixed(t.config.decimals)+t.config.symbol}if(t.config.counter===true){eve.on("raphael.anim.frame."+t.level.id,function(){var e=t.level.attr("pki");if(t.config.textRenderer){t.txtValue.attr("text",t.config.textRenderer(Math.floor(e[0])))}else if(t.config.humanFriendly){t.txtValue.attr("text",humanFriendlyNumber(Math.floor(e[0]),t.config.humanFriendlyDecimal)+t.config.symbol)}else if(t.config.formatNumber){t.txtValue.attr("text",formatNumber(Math.floor(e[0]))+t.config.symbol)}else{t.txtValue.attr("text",(e[0]*1).toFixed(t.config.decimals)+t.config.symbol)}setDy(t.txtValue,t.params.valueFontSize,t.params.valueY);e=null});eve.on("raphael.anim.finish."+t.level.id,function(){t.txtValue.attr({text:t.originalValue});setDy(t.txtValue,t.params.valueFontSize,t.params.valueY)})}else{eve.on("raphael.anim.start."+t.level.id,function(){t.txtValue.attr({text:t.originalValue});setDy(t.txtValue,t.params.valueFontSize,t.params.valueY)})}t.level.animate({pki:[t.config.value,t.config.min,t.config.max,t.params.widgetW,t.params.widgetH,t.params.dx,t.params.dy,t.config.gaugeWidthScale,t.config.donut]},t.config.startAnimationTime,t.config.startAnimationType);t.txtValue.animate({"fill-opacity":t.config.hideValue?"0":"1"},t.config.startAnimationTime,t.config.startAnimationType);t.txtLabel.animate({"fill-opacity":"1"},t.config.startAnimationTime,t.config.startAnimationType)};JustGage.prototype.kvLookup=function(e,t,n,r,i,s){var o=r;var u=false;if(!(e===null||e===undefined)){if(n!==null&&n!==undefined&&typeof n==="object"&&e in n){o=n[e];u=true}else if(t!==null&&t!==undefined&&typeof t==="object"&&e in t){o=t[e];u=true}else{o=r}if(u===true){if(i!==null&&i!==undefined){switch(i){case"int":o=parseInt(o,10);break;case"float":o=parseFloat(o);break;default:break}}}}return o};JustGage.prototype.refresh=function(e,t){var n=this;var r,i,t=t||null;if(t!==null){n.config.max=t;n.txtMaximum=n.config.max;if(n.config.humanFriendly){n.txtMaximum=humanFriendlyNumber(n.config.max,n.config.humanFriendlyDecimal)}else if(n.config.formatNumber){n.txtMaximum=formatNumber(n.config.max)}n.txtMax.attr({text:n.txtMaximum});setDy(n.txtMax,n.params.maxFontSize,n.params.maxY)}r=e;if(e*1>n.config.max*1){e=n.config.max*1}if(e*1<n.config.min*1){e=n.config.min*1}i=getColor(e,(e-n.config.min)/(n.config.max-n.config.min),n.config.levelColors,n.config.noGradient,n.config.customSectors);if(n.config.textRenderer){r=n.config.textRenderer(r)}else if(n.config.humanFriendly){r=humanFriendlyNumber(r,n.config.humanFriendlyDecimal)+n.config.symbol}else if(n.config.formatNumber){r=formatNumber((r*1).toFixed(n.config.decimals))+n.config.symbol}else{r=(r*1).toFixed(n.config.decimals)+n.config.symbol}n.originalValue=r;n.config.value=e*1;if(!n.config.counter){n.txtValue.attr({text:r});setDy(n.txtValue,n.params.valueFontSize,n.params.valueY)}n.level.animate({pki:[n.config.value,n.config.min,n.config.max,n.params.widgetW,n.params.widgetH,n.params.dx,n.params.dy,n.config.gaugeWidthScale,n.config.donut],fill:i},n.config.refreshAnimationTime,n.config.refreshAnimationType);n,r,i,t=null};JustGage.prototype.generateShadow=function(e,t){var n=this;var r,i,s,o,u,a,f;r=document.createElementNS(e,"filter");r.setAttribute("id","inner-shadow");t.appendChild(r);i=document.createElementNS(e,"feOffset");i.setAttribute("dx",0);i.setAttribute("dy",n.config.shadowVerticalOffset);r.appendChild(i);s=document.createElementNS(e,"feGaussianBlur");s.setAttribute("result","offset-blur");s.setAttribute("stdDeviation",n.config.shadowSize);r.appendChild(s);o=document.createElementNS(e,"feComposite");o.setAttribute("operator","out");o.setAttribute("in","SourceGraphic");o.setAttribute("in2","offset-blur");o.setAttribute("result","inverse");r.appendChild(o);u=document.createElementNS(e,"feFlood");u.setAttribute("flood-color","black");u.setAttribute("flood-opacity",n.config.shadowOpacity);u.setAttribute("result","color");r.appendChild(u);a=document.createElementNS(e,"feComposite");a.setAttribute("operator","in");a.setAttribute("in","color");a.setAttribute("in2","inverse");a.setAttribute("result","shadow");r.appendChild(a);f=document.createElementNS(e,"feComposite");f.setAttribute("operator","over");f.setAttribute("in","shadow");f.setAttribute("in2","SourceGraphic");r.appendChild(f);if(!n.config.hideInnerShadow){n.canvas.canvas.childNodes[2].setAttribute("filter","url(#inner-shadow)");n.canvas.canvas.childNodes[3].setAttribute("filter","url(#inner-shadow)")}r,i,s,o,u,a,f=null};var ie=function(){var e,t=3,n=document.createElement("div"),r=n.getElementsByTagName("i");while(n.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",r[0]);return t>4?t:e}()
